<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Projeto FÃªnix â€” Planner DiÃ¡rio</title>
<meta name="theme-color" content="#c084fc">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
body { font-family: 'Inter', sans-serif; background-color: #fdfbf7; color: #3d3d3d; }
h1,h2,h3,.font-serif { font-family: 'Playfair Display', serif; }
.mood-btn { padding:.5rem 1rem; border-radius:1rem; border:1px solid #ddd; cursor:pointer; transition:.2s; text-align: center; font-size: 0.875rem; }
.mood-btn.active { background:#c084fc; color:white; border-color:#c084fc; transform: scale(1.05); box-shadow:0 4px 12px rgba(0,0,0,.2); }
textarea,input { outline:none; }
</style>
</head>
<body class="min-h-screen flex flex-col pb-20">

<header class="sticky top-0 bg-white/80 backdrop-blur-md border-b border-[#e8e2d9] p-4 flex justify-between items-center z-50">
<h1 class="text-xl md:text-3xl font-bold text-[#c084fc]">Projeto FÃªnix <span class="text-[#a89f91] font-light italic">2026</span></h1>
<button id="install-btn" class="p-2 rounded-full bg-[#c084fc] text-white shadow-md hidden text-sm px-4">Instalar App</button>
</header>

<main class="max-w-3xl w-full mx-auto px-6 py-10 flex-grow">
  <div id="view-today">
    <div class="mb-6 flex flex-col md:flex-row md:justify-between md:items-end gap-4">
      <div>
        <h2 id="display-dayname" class="text-4xl font-serif capitalize">...</h2>
        <p id="display-date" class="text-gray-400 uppercase text-xs tracking-widest">...</p>
      </div>
      <input type="date" id="input-date" class="border border-[#e8e2d9] px-3 py-2 rounded-lg bg-white text-sm" onchange="loadDate(this.value)" />
    </div>

    <div class="mb-6 p-6 bg-gradient-to-br from-[#f7f0e8] to-white rounded-2xl shadow-sm text-center border border-[#eee6de]">
      <p class="text-[10px] uppercase tracking-widest text-[#c67b5c] font-black mb-2">InspiraÃ§Ã£o FÃªnix</p>
      <blockquote id="display-phrase" class="text-xl md:text-2xl font-serif italic text-[#5d4a44]">...</blockquote>
    </div>

    <div class="mb-6">
      <h3 class="font-serif font-bold mb-3 text-lg">ğŸŒ¿ Check-in Emocional</h3>
      <div id="mood-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-2"></div>
    </div>

    <div class="mb-6">
      <h3 class="font-serif font-bold mb-1 text-lg">ğŸª ReflexÃ£o Profunda</h3>
      <p id="display-question" class="italic mb-3 text-[#c67b5c] font-medium text-sm">Carregando pergunta...</p>
      <textarea id="field-reconnection" class="w-full border border-[#e8e2d9] rounded-xl p-4 min-h-[120px] focus:ring-2 focus:ring-[#c084fc]/20" placeholder="Sua alma responde..." oninput="saveCurrent()"></textarea>
    </div>

    <div class="mb-6">
      <h3 class="font-serif font-bold mb-3 text-lg">âœï¸ Escrita TerapÃªutica</h3>
      <textarea id="field-writing" class="w-full border border-[#e8e2d9] rounded-xl p-6 min-h-[200px] focus:ring-2 focus:ring-[#c084fc]/20" placeholder="Escreva livremente..." oninput="saveCurrent()"></textarea>
    </div>

    <div class="grid md:grid-cols-2 gap-6">
      <div>
        <h3 class="font-serif font-bold mb-3 text-lg">Autocuidado</h3>
        <textarea id="field-selfcare" class="w-full border border-[#e8e2d9] rounded-xl p-4 min-h-[100px] focus:ring-2 focus:ring-[#c084fc]/20" placeholder="O que vocÃª fez por vocÃª?" oninput="saveCurrent()"></textarea>
      </div>
      <div>
        <h3 class="font-serif font-bold mb-3 text-lg">Ã‚ncora do Dia</h3>
        <input type="text" id="field-keyword" class="w-full border border-[#e8e2d9] rounded-xl p-4 text-center font-bold text-[#c084fc] text-xl focus:ring-2 focus:ring-[#c084fc]/20" placeholder="Uma palavra..." oninput="saveCurrent()" />
      </div>
    </div>

    <div class="mt-10 flex justify-center">
        <button onclick="downloadBackup()" class="text-[#a89f91] text-xs underline uppercase tracking-widest">Baixar Backup de Dados</button>
    </div>
  </div>
</main>

<script>
const FRASES_INSPIRACAO = [
    "A fÃªnix nÃ£o apenas renasce, ela escolhe o que deixar virar cinzas.", "Sua luz interna Ã© o guia mais seguro em tempos de mudanÃ§a.", "Honre o seu ritmo; atÃ© o sol tem seu tempo de se pÃ´r para brilhar de novo.", "Pequenos passos diÃ¡rios constroem caminhos extraordinÃ¡rios.", "A cura nÃ£o Ã© linear, mas a persistÃªncia Ã© transformadora.", "VocÃª Ã© o autor da sua prÃ³pria metamorfose.", "Onde houver sombra, lembre-se de que hÃ¡ uma luz por perto.", "Sua essÃªncia Ã© inabalÃ¡vel, mesmo quando tudo ao redor parece mudar.", "Cultive o jardim interno e as borboletas virÃ£o.", "A coragem nÃ£o Ã© a ausÃªncia de medo, mas o agir apesar dele.", "Permita-se recomeÃ§ar quantas vezes forem necessÃ¡rias.", "Sua histÃ³ria de superaÃ§Ã£o Ã© o mapa para o seu sucesso.", "O autocuidado Ã© a fundaÃ§Ã£o de todo o resto.", "Seja gentil consigo mesma; vocÃª estÃ¡ fazendo o seu melhor.", "A paciÃªncia Ã© a chave que abre as portas do amadurecimento.", "Brilhe sem pedir licenÃ§a; o mundo precisa da sua luz.", "A gratidÃ£o transforma o que temos em suficiente.", "Sua forÃ§a reside na sua vulnerabilidade.", "Mantenha os pÃ©s no chÃ£o e os olhos nas estrelas.", "Cada novo amanhecer Ã© uma pÃ¡gina em branco para o seu renascimento.", "NÃ£o compare o seu capÃ­tulo um com o capÃ­tulo vinte de outra pessoa.", "A paz comeÃ§a dentro de vocÃª.", "Transforme suas cicatrizes em medalhas de honra.", "Acredite na magia dos novos comeÃ§os.", "VocÃª Ã© mais forte do que imagina e mais capaz do que acredita.", "A felicidade Ã© um caminho, nÃ£o um destino.", "Escute a voz da sua intuiÃ§Ã£o; ela conhece o caminho.", "Semeie amor e colha liberdade.", "O agora Ã© o Ãºnico lugar onde a vida acontece.", "Celebre suas pequenas vitÃ³rias, elas sÃ£o o alicerce das grandes.", "Renascer exige coragem para deixar ir o que nÃ£o serve mais."
];

const PERGUNTAS_REFLEXAO = [
    "Qual parte de vocÃª estÃ¡ pronta para florescer hoje?", "O que vocÃª pode soltar agora para se sentir mais leve?", "Pelo que o seu 'eu' do futuro te agradeceria hoje?", "Como vocÃª pode ser seu prÃ³prio refÃºgio neste momento?", "Qual foi a Ãºltima vez que vocÃª se orgulhou da sua coragem?", "O que o seu silÃªncio estÃ¡ tentando te dizer hoje?", "Como vocÃª pode nutrir sua alma nas prÃ³ximas horas?", "Qual hÃ¡bito antigo vocÃª estÃ¡ pronta para transformar em cinzas?", "Se o medo nÃ£o existisse, o que vocÃª faria agora?", "O que traz um brilho genuÃ­no aos seus olhos?", "Como vocÃª pode ser 1% mais gentil consigo mesma hoje?", "Qual Ã© a sua Ã¢ncora nos dias de tempestade?", "O que vocÃª aprendeu sobre si mesma na Ãºltima semana?", "Quais sÃ£o os limites que vocÃª precisa estabelecer para sua paz?", "Se a sua vida fosse um livro, qual seria o tÃ­tulo do capÃ­tulo de hoje?", "Pelo que vocÃª Ã© profundamente grata, mas raramente menciona?", "Como vocÃª pode expressar sua criatividade hoje?", "O que significa 'sucesso' para vocÃª neste exato momento?", "Qual pensamento vocÃª quer plantar na sua mente ao acordar?", "Como vocÃª lida com as suas sombras e inseguranÃ§as?", "Qual Ã© o seu maior superpoder emocional?", "Se vocÃª pudesse dizer algo ao seu 'eu' de 10 anos atrÃ¡s, o que seria?", "O que vocÃª estÃ¡ adiando que traria paz ao seu coraÃ§Ã£o?", "Como vocÃª pode tornar seu ambiente um lugar mais sagrado?", "O que vocÃª descobriu que nÃ£o precisa mais carregar?", "Qual Ã© a intenÃ§Ã£o mais pura por trÃ¡s das suas aÃ§Ãµes de hoje?", "Como vocÃª define a sua prÃ³pria liberdade?", "O que faz vocÃª se sentir verdadeiramente conectada com a vida?", "Qual Ã© a liÃ§Ã£o que o obstÃ¡culo de hoje estÃ¡ tentando te ensinar?", "Como vocÃª quer ser lembrada pelas pessoas que cruzarem seu caminho?", "O que vocÃª escolhe abraÃ§ar hoje: o controle ou a entrega?"
];

let entries = JSON.parse(localStorage.getItem('projeto_fenix_data') || '[]');
let currentDate = new Date().toISOString().split('T')[0];
let currentEntry = null;
const MOODS = ['Leve','Cansada','Inspirada','Ansiosa','Grata','Presente'];

const renderMoods = () => {
  const grid = document.getElementById('mood-grid');
  grid.innerHTML = MOODS.map(m => `<button class="mood-btn ${currentEntry?.mood === m ? 'active' : ''}" onclick="setMood('${m}')">${m}</button>`).join('');
};

window.setMood = (mood) => {
  currentEntry.mood = mood;
  renderMoods();
  saveCurrent();
};

window.loadDate = (date) => {
  currentDate = date;
  document.getElementById('input-date').value = date;
  const d = new Date(date + 'T12:00:00');
  
  document.getElementById('display-dayname').innerText = d.toLocaleDateString('pt-BR', { weekday: 'long' });
  document.getElementById('display-date').innerText = d.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' });

  // Pega o Ã­ndice baseado no dia (0 a 30)
  const dayOfMonth = d.getDate() - 1;
  const dailyPhrase = FRASES_INSPIRACAO[dayOfMonth % 31];
  const dailyQuestion = PERGUNTAS_REFLEXAO[dayOfMonth % 31];

  let existing = entries.find(e => e.date === date);

  if (existing) {
    currentEntry = existing;
    // ForÃ§a a atualizaÃ§Ã£o se os campos estiverem vazios ou indefinidos
    if (!currentEntry.phrase || currentEntry.phrase === "Sintonizando...") currentEntry.phrase = dailyPhrase;
    if (!currentEntry.question || currentEntry.question === "...") currentEntry.question = dailyQuestion;
  } else {
    currentEntry = { date, phrase: dailyPhrase, question: dailyQuestion, mood: '', reconnection: '', writing: '', selfcare: '', keyword: '' };
  }

  // RenderizaÃ§Ã£o na tela com proteÃ§Ã£o total contra undefined
  document.getElementById('display-phrase').innerText = currentEntry.phrase || dailyPhrase;
  document.getElementById('display-question').innerText = currentEntry.question || dailyQuestion;
  document.getElementById('field-reconnection').value = currentEntry.reconnection || "";
  document.getElementById('field-writing').value = currentEntry.writing || "";
  document.getElementById('field-selfcare').value = currentEntry.selfcare || "";
  document.getElementById('field-keyword').value = currentEntry.keyword || "";

  renderMoods();
};

window.saveCurrent = () => {
  if (!currentEntry) return;
  currentEntry.reconnection = document.getElementById('field-reconnection').value;
  currentEntry.writing = document.getElementById('field-writing').value;
  currentEntry.selfcare = document.getElementById('field-selfcare').value;
  currentEntry.keyword = document.getElementById('field-keyword').value;

  const idx = entries.findIndex(e => e.date === currentEntry.date);
  if (idx > -1) entries[idx] = currentEntry;
  else entries.push(currentEntry);

  localStorage.setItem('projeto_fenix_data', JSON.stringify(entries));
};

window.downloadBackup = () => {
  const blob = new Blob([JSON.stringify(entries, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url;
  a.download = `backup-fenix-${currentDate}.json`;
  a.click();
};

// Inicializa o app
loadDate(currentDate);

// PWA Logic
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById('install-btn').classList.remove('hidden');
});

document.getElementById('install-btn').addEventListener('click', async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    deferredPrompt = null;
    document.getElementById('install-btn').classList.add('hidden');
  }
});

if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js').catch(() => {});
  });
}
</script>
</body>
</html>
