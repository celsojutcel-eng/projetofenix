<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Projeto FÃªnix - Planner 2026</title>

  <!-- Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#c67b5c">

  <!-- Fontes e Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* =======================
       Estilos principais
    ======================= */
    :root {
      --color-bg: #fdfbf7;
      --color-primary: #c67b5c;
      --color-secondary: #5d4a44;
      --color-accent: #8ba68b;
      --color-text: #3d3d3d;
      --color-muted: #a89f91;
      --color-border: #e8e2d9;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--color-bg);
      color: var(--color-text);
      scroll-behavior: smooth;
    }

    h1, h2, h3, .font-serif { font-family: 'Playfair Display', serif; }

    .card {
      background: white;
      border: 1px solid var(--color-border);
      border-radius: 1.5rem;
      box-shadow: 0 4px 20px -5px rgba(0,0,0,0.05);
    }

    .input-elegant {
      background: #fdfbf7;
      border: 1px solid var(--color-border);
      border-radius: 1rem;
      padding: 1rem;
      width: 100%;
      transition: all 0.3s ease;
    }

    .input-elegant:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(198, 123, 92, 0.1);
    }

    .btn-mood {
      padding: 0.75rem 1rem;
      border-radius: 1rem;
      border: 1px solid var(--color-border);
      font-size: 0.875rem;
      transition: all 0.2s;
      background: white;
    }

    .btn-mood.active {
      background: var(--color-primary);
      color: white;
      border-color: var(--color-primary);
      transform: scale(1.05);
    }

    .fade-in { animation: fadeIn 0.4s ease-out forwards; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }

    .loader {
      border: 3px solid #f3f3f3;
      border-top: 3px solid var(--color-primary);
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 0% {transform:rotate(0deg);} 100% {transform:rotate(360deg);} }

    .view { display: none; }
    .view.active { display: block; }
  </style>
</head>
<body class="pb-24 md:pb-8">

  <!-- Header -->
  <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-[#e8e2d9]">
    <div class="max-w-4xl mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between gap-4">
      <div class="text-center md:text-left">
        <h1 class="text-2xl md:text-3xl font-bold text-[#c67b5c]">
          Projeto FÃªnix <span class="text-[#a89f91] font-light italic">2026</span>
        </h1>
        <p class="text-[10px] uppercase tracking-[0.2em] text-[#a89f91] font-bold">Redescubra sua essÃªncia diariamente</p>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-3xl mx-auto px-4 py-8">
    <!-- Aqui entra todo o conteÃºdo do app -->
    <!-- Mantenha suas views TODAY, HISTORY, INSIGHTS e entry-form -->
  </main>

  <!-- Feedback de Salva -->
  <div id="save-indicator" class="fixed bottom-24 right-6 md:bottom-8 bg-white/90 backdrop-blur border border-gray-200 px-4 py-2 rounded-full text-[10px] font-bold text-gray-400 shadow-lg hidden">
    Sincronizando com sua essÃªncia...
  </div>

  <!-- ===============================
       JS do App (mantido igual)
  =============================== -->
  <script>
    // FunÃ§Ã£o para pegar a data local no formato yyyy-mm-dd
    function getLocalDate() {
      const today = new Date();
      const year = today.getFullYear();
      const month = String(today.getMonth()+1).padStart(2,'0');
      const day = String(today.getDate()).padStart(2,'0');
      return `${year}-${month}-${day}`;
    }

    let state = {
      currentView:'today',
      selectedDate:getLocalDate(),
      entries:JSON.parse(localStorage.getItem('projeto_fenix_data')||'[]'),
      currentEntry:null
    };

    const MOODS = ['Leve','Cansada','Inspirada','Ansiosa','Presente','Confusa','Grata','Empoderada'];

    const FALLBACK_CONTENT = [
      { phrase:"O renascimento comeÃ§a quando vocÃª se escuta.", question:"O que sua alma pede hoje?" },
      { phrase:"Seu ritmo tambÃ©m Ã© sagrado.", question:"Onde vocÃª pode ser mais gentil consigo?" },
      { phrase:"HÃ¡ forÃ§a no silÃªncio.", question:"O que precisa de pausa agora?" }
    ];

    window.onload = () => {
      loadDailyEntry(state.selectedDate);
      renderMoods();
      setupListeners();
    };

    function switchView(view){
      state.currentView = view;
      document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
      document.getElementById(`view-${view}`).classList.add('active');
    }

    function loadDailyEntry(date){
      const form = document.getElementById('entry-form');
      const loading = document.getElementById('loading-overlay');
      let entry = state.entries.find(e=>e.date===date);
      if(!entry){
        const r=FALLBACK_CONTENT[Math.floor(Math.random()*FALLBACK_CONTENT.length)];
        entry={date, phrase:r.phrase, question:r.question, mood:'', reconnection:'', writing:'', selfcare:'', keyword:''};
        state.entries.push(entry);
        saveData();
      }
      state.currentEntry = entry;
      populateForm(entry);
      loading.classList.add('hidden');
      form.classList.remove('hidden');
    }

    function populateForm(e){
      document.getElementById('display-phrase').textContent=`"${e.phrase}"`;
      document.getElementById('display-question').textContent=e.question;
    }

    function renderMoods(){
      const container=document.getElementById('mood-container');
      container.innerHTML='';
      MOODS.forEach(mood=>{
        const btn=document.createElement('button');
        btn.className='btn-mood';
        btn.textContent=mood;
        btn.onclick=()=>{
          state.currentEntry.mood=mood;
          saveData();
          renderMoods();
        };
        if(state.currentEntry?.mood===mood) btn.classList.add('active');
        container.appendChild(btn);
      });
    }

    function setupListeners(){
      document.getElementById('date-picker').value=state.selectedDate;
      document.getElementById('date-picker').onchange=e=>{
        state.selectedDate=e.target.value;
        loadDailyEntry(state.selectedDate);
      };
      [['input-reconnection','reconnection'],['input-writing','writing'],['input-selfcare','selfcare'],['input-keyword','keyword']]
      .forEach(([id,key])=>{
        const el=document.getElementById(id);
        el.oninput=e=>{
          state.currentEntry[key]=e.target.value;
          saveData();
        };
      });
    }

    function saveData(){
      localStorage.setItem('projeto_fenix_data',JSON.stringify(state.entries));
    }

    // ===============================
    // Service Worker
    // ===============================
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('service-worker.js')
      .then(()=>console.log('Service Worker registrado!'))
      .catch(err=>console.log('Erro ao registrar SW:',err));
    }
  </script>

  <!-- ===============================
       BotÃ£o PWA customizado
  =============================== -->
  <script>
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e)=>{
      e.preventDefault();
      deferredPrompt=e;

      const installBtn=document.createElement('button');
      installBtn.textContent="ðŸ“² Instalar Projeto FÃªnix";
      installBtn.id="install-btn";
      installBtn.style.position="fixed";
      installBtn.style.bottom="16px";
      installBtn.style.right="16px";
      installBtn.style.background="#c67b5c";
      installBtn.style.color="white";
      installBtn.style.border="none";
      installBtn.style.borderRadius="1rem";
      installBtn.style.padding="0.75rem 1rem";
      installBtn.style.fontWeight="bold";
      installBtn.style.boxShadow="0 4px 12px rgba(0,0,0,0.2)";
      installBtn.style.cursor="pointer";
      document.body.appendChild(installBtn);

      installBtn.addEventListener('click', async ()=>{
        installBtn.disabled=true;
        deferredPrompt.prompt();
        const {outcome}=await deferredPrompt.userChoice;
        if(outcome==='accepted') console.log("UsuÃ¡rio aceitou instalar o PWA!");
        else console.log("UsuÃ¡rio rejeitou instalar o PWA.");
        deferredPrompt=null;
        installBtn.remove();
      });
    });
  </script>
</body>
</html>
