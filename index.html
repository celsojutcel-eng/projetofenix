<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Projeto FÃªnix â€” Planner DiÃ¡rio</title>
<meta name="theme-color" id="meta-theme-color" content="#c084fc">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
body { font-family: 'Inter', sans-serif; background-color: #fdfbf7; color: #3d3d3d; transition: background-color 0.4s; }
h1,h2,h3,.font-serif { font-family: 'Playfair Display', serif; }
.mood-btn { padding:.5rem 1rem; border-radius:1rem; border:2px solid #ddd; cursor:pointer; transition:.3s; text-align: center; font-size: 0.875rem; background: white; font-weight: 500; }
.mood-btn.active { color: white !important; transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-color: transparent !important; }
textarea, input { outline: none; border: 1px solid #e8e2d9 !important; border-radius: 12px; padding: 1rem; }
::placeholder { color: #a89f91; opacity: 0.5; }
</style>
</head>
<body class="min-h-screen flex flex-col pb-20">

<header class="sticky top-0 bg-white/80 backdrop-blur-md border-b border-[#e8e2d9] p-4 flex justify-between items-center z-50">
<h1 id="main-title" class="text-xl md:text-3xl font-bold">Projeto FÃªnix <span class="text-[#a89f91] font-light italic text-sm md:text-lg">2026</span></h1>
<button id="install-btn" class="hidden p-2 rounded-full text-white shadow-md text-sm px-4 font-bold" style="background-color: #c084fc;">Instalar App</button>
</header>

<main class="max-w-3xl w-full mx-auto px-6 py-10 flex-grow">
    <div class="mb-6 flex flex-col md:flex-row md:justify-between md:items-end gap-4">
      <div>
        <h2 id="display-dayname" class="text-4xl font-serif capitalize">...</h2>
        <p id="display-date" class="text-gray-400 uppercase text-xs tracking-widest">...</p>
      </div>
      <input type="date" id="input-date" class="bg-white text-sm" onchange="loadDate(this.value)" />
    </div>

    <div class="mb-6 p-6 bg-gradient-to-br from-[#f7f0e8] to-white rounded-2xl shadow-sm text-center border border-[#eee6de]">
      <p class="text-[10px] uppercase tracking-widest text-[#c67b5c] font-black mb-2">InspiraÃ§Ã£o FÃªnix</p>
      <blockquote id="display-phrase" class="text-xl md:text-2xl font-serif italic text-[#5d4a44]">...</blockquote>
    </div>

    <div class="mb-6">
      <h3 class="font-serif font-bold mb-3 text-lg">ğŸŒ¿ Check-in Emocional</h3>
      <div id="mood-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-2"></div>
    </div>

    <div class="mb-6">
      <h3 class="font-serif font-bold mb-1 text-lg">ğŸª ReflexÃ£o Profunda</h3>
      <p id="display-question" class="italic mb-3 font-semibold text-sm">...</p>
      <textarea id="field-reconnection" class="w-full min-h-[120px]" placeholder="Sua alma responde..." oninput="saveCurrent()"></textarea>
    </div>

    <div class="mb-6">
      <h3 class="font-serif font-bold mb-3 text-lg">âœï¸ Escrita TerapÃªutica</h3>
      <textarea id="field-writing" class="w-full min-h-[200px]" placeholder="Escreva livremente..." oninput="saveCurrent()"></textarea>
    </div>

    <div class="grid md:grid-cols-2 gap-6 mb-10">
      <div>
        <h3 class="font-serif font-bold mb-3 text-lg">Autocuidado</h3>
        <textarea id="field-selfcare" class="w-full min-h-[100px]" placeholder="O que vocÃª fez por vocÃª?" oninput="saveCurrent()"></textarea>
      </div>
      <div>
        <h3 class="font-serif font-bold mb-3 text-lg">Ã‚ncora do Dia</h3>
        <input type="text" id="field-keyword" class="w-full text-center font-extrabold text-2xl" placeholder="Ex: Pausa" oninput="saveCurrent()" />
      </div>
    </div>

    <div class="flex flex-col items-center gap-4">
        <button onclick="downloadBackup()" class="bg-[#3d3d3d] text-white px-8 py-3 rounded-full font-bold shadow-lg hover:opacity-90 transition-all flex items-center gap-2">
            ğŸ“¥ Baixar Meus Dados (Backup)
        </button>
        <p class="text-xs text-gray-400">Os dados sÃ£o salvos automaticamente no seu navegador.</p>
    </div>
</main>

<script>
// (Mantemos as mesmas listas FRASES_INSPIRACAO e PERGUNTAS_REFLEXAO do cÃ³digo anterior aqui)
const FRASES_INSPIRACAO = ["A fÃªnix nÃ£o apenas renasce, ela escolhe o que deixar virar cinzas.", "Sua luz interna Ã© o guia mais seguro em tempos de mudanÃ§a.", "Honre o seu ritmo; atÃ© o sol tem seu tempo de se pÃ´r para brilhar de novo.", "Pequenos passos diÃ¡rios constroem caminhos extraordinÃ¡rios.", "A cura nÃ£o Ã© linear, mas a persistÃªncia Ã© transformadora.", "VocÃª Ã© o autor da sua prÃ³pria metamorfose.", "Onde houver sombra, lembre-se de que hÃ¡ uma luz por perto.", "Sua essÃªncia Ã© inabalÃ¡vel, mesmo quando tudo ao redor parece mudar.", "Cultive o jardim interno e as borboletas virÃ£o.", "A coragem nÃ£o Ã© a ausÃªncia de medo, mas o agir apesar dele.", "Permita-se recomeÃ§ar quantas vezes forem necessÃ¡rias.", "Sua histÃ³ria de superaÃ§Ã£o Ã© o mapa para o seu sucesso.", "O autocuidado Ã© a fundaÃ§Ã£o de todo o resto.", "Seja gentil consigo mesma; vocÃª estÃ¡ fazendo o seu melhor.", "A paciÃªncia Ã© a chave que abre as portas do amadurecimento.", "Brilhe sem pedir licenÃ§a; o mundo precisa da sua luz.", "A gratidÃ£o transforma o que temos em suficiente.", "Sua forÃ§a reside na sua vulnerabilidade.", "Mantenha os pÃ©s no chÃ£o e os olhos nas estrelas.", "Cada novo amanhecer Ã© uma pÃ¡gina em branco para o seu renascimento.", "NÃ£o compare o seu capÃ­tulo um com o capÃ­tulo vinte de outra pessoa.", "A paz comeÃ§a dentro de vocÃª.", "Transforme suas cicatrizes em medalhas de honra.", "Acredite na magia dos novos comeÃ§os.", "VocÃª Ã© mais forte do que imagina e mais capaz do que acredita.", "A felicidade Ã© um caminho, nÃ£o um destino.", "Escute a voz da sua intuiÃ§Ã£o; ela conhece o caminho.", "Semeie amor e colha liberdade.", "O agora Ã© o Ãºnico lugar onde a vida acontece.", "Celebre suas pequenas vitÃ³rias, elas sÃ£o o alicerce das grandes.", "Renascer exige coragem para deixar ir o que nÃ£o serve mais."];
const PERGUNTAS_REFLEXAO = ["Qual parte de vocÃª estÃ¡ pronta para florescer hoje?", "O que vocÃª pode soltar agora para se sentir mais leve?", "Pelo que o seu 'eu' do futuro te agradeceria hoje?", "Como vocÃª pode ser seu prÃ³prio refÃºgio neste momento?", "Qual foi a Ãºltima vez que vocÃª se orgulhou da sua coragem?", "O que o seu silÃªncio estÃ¡ tentando te dizer hoje?", "Como vocÃª pode nutrir sua alma nas prÃ³ximas horas?", "Qual hÃ¡bito antigo vocÃª estÃ¡ pronta para transformar em cinzas?", "Se o medo nÃ£o existisse, o que vocÃª faria agora?", "O que traz um brilho genuÃ­no aos seus olhos?", "Como vocÃª pode ser 1% mais gentil consigo mesma hoje?", "Qual Ã© a sua Ã¢ncora nos dias de tempestade?", "O que vocÃª aprendeu sobre si mesma na Ãºltima semana?", "Quais sÃ£o os limites que vocÃª precisa estabelecer para sua paz?", "Se a sua vida fosse um livro, qual seria o tÃ­tulo do capÃ­tulo de hoje?", "Pelo que vocÃª Ã© profundamente grata, mas raramente menciona?", "Como vocÃª pode expressar sua criatividade hoje?", "O que significa 'sucesso' para vocÃª neste exato momento?", "Qual pensamento vocÃª quer plantar na sua mente ao acordar?", "Como vocÃª lida com as suas sombras e inseguranÃ§as?", "Qual Ã© o seu maior superpoder emocional?", "Se vocÃª pudesse dizer algo ao seu 'eu' de 10 anos atrÃ¡s, o que seria?", "O que vocÃª estÃ¡ adiando que traria paz ao seu coraÃ§Ã£o?", "Como vocÃª pode tornar seu ambiente um lugar mais sagrado?", "O que vocÃª descobriu que nÃ£o precisa mais carregar?", "Qual Ã© a intenÃ§Ã£o mais pura por trÃ¡s das suas aÃ§Ãµes de hoje?", "Como vocÃª define a sua prÃ³pria liberdade?", "O que faz vocÃª se sentir verdadeiramente conectada com a vida?", "Qual Ã© a liÃ§Ã£o que o obstÃ¡culo de hoje estÃ¡ tentando te ensinar?", "Como vocÃª quer ser lembrada pelas pessoas que cruzarem seu caminho?", "O que vocÃª escolhe abraÃ§ar hoje: o controle ou a entrega?"];

const MOODS = [
    {label: 'Leve', color: '#c084fc'}, {label: 'Cansada', color: '#94a3b8'}, {label: 'Inspirada', color: '#fbbf24'},
    {label: 'Ansiosa', color: '#f87171'}, {label: 'Grata', color: '#4ade80'}, {label: 'Presente', color: '#2dd4bf'}
];

let entries = JSON.parse(localStorage.getItem('projeto_fenix_data') || '[]');
let currentDate = new Date().toISOString().split('T')[0];
let currentEntry = null;

const clean = (val) => (val === undefined || val === null || String(val).includes('undefined')) ? "" : val;

const updateTheme = (color) => {
    const themeColor = color || '#c084fc';
    document.getElementById('main-title').style.setProperty('color', themeColor, 'important');
    document.getElementById('display-question').style.setProperty('color', themeColor, 'important');
    document.getElementById('field-keyword').style.setProperty('color', themeColor, 'important');
    document.getElementById('install-btn').style.setProperty('background-color', themeColor, 'important');
};

const renderMoods = () => {
  const grid = document.getElementById('mood-grid');
  grid.innerHTML = MOODS.map(m => {
    const isActive = currentEntry?.mood === m.label;
    return `<button class="mood-btn ${isActive ? 'active' : ''}" 
            style="border-color: ${m.color} !important; ${isActive ? 'background-color:'+m.color+' !important;' : 'color:'+m.color}"
            onclick="setMood('${m.label}', '${m.color}')">${m.label}</button>`;
  }).join('');
};

window.setMood = (label, color) => {
  currentEntry.mood = label;
  updateTheme(color);
  renderMoods();
  saveCurrent();
};

window.loadDate = (date) => {
  currentDate = date;
  document.getElementById('input-date').value = date;
  const d = new Date(date + 'T12:00:00');
  const dayIndex = d.getDate() - 1;

  document.getElementById('display-dayname').innerText = d.toLocaleDateString('pt-BR', { weekday: 'long' });
  document.getElementById('display-date').innerText = d.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' });

  let existing = entries.find(e => e.date === date);
  if (existing) {
    currentEntry = existing;
  } else {
    currentEntry = { date, phrase: FRASES_INSPIRACAO[dayIndex % 31], question: PERGUNTAS_REFLEXAO[dayIndex % 31], mood: '', reconnection: '', writing: '', selfcare: '', keyword: '' };
  }

  document.getElementById('display-phrase').innerText = clean(currentEntry.phrase) || FRASES_INSPIRACAO[dayIndex % 31];
  document.getElementById('display-question').innerText = clean(currentEntry.question) || PERGUNTAS_REFLEXAO[dayIndex % 31];
  document.getElementById('field-reconnection').value = clean(currentEntry.reconnection);
  document.getElementById('field-writing').value = clean(currentEntry.writing);
  document.getElementById('field-selfcare').value = clean(currentEntry.selfcare);
  document.getElementById('field-keyword').value = clean(currentEntry.keyword);

  const currentMoodObj = MOODS.find(m => m.label === currentEntry.mood);
  updateTheme(currentMoodObj ? currentMoodObj.color : '#c084fc');
  renderMoods();
};

window.saveCurrent = () => {
  if (!currentEntry) return;
  currentEntry.reconnection = clean(document.getElementById('field-reconnection').value);
  currentEntry.writing = clean(document.getElementById('field-writing').value);
  currentEntry.selfcare = clean(document.getElementById('field-selfcare').value);
  currentEntry.keyword = clean(document.getElementById('field-keyword').value);

  const idx = entries.findIndex(e => e.date === currentEntry.date);
  if (idx > -1) entries[idx] = currentEntry;
  else entries.push(currentEntry);
  localStorage.setItem('projeto_fenix_data', JSON.stringify(entries));
};

// FUNÃ‡ÃƒO DE BACKUP (DOWNLOAD JSON)
window.downloadBackup = () => {
    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(entries, null, 2));
    const downloadAnchorNode = document.createElement('a');
    downloadAnchorNode.setAttribute("href", dataStr);
    downloadAnchorNode.setAttribute("download", "meu-planner-fenix.json");
    document.body.appendChild(downloadAnchorNode);
    downloadAnchorNode.click();
    downloadAnchorNode.remove();
};

loadDate(currentDate);

// --- LÃ“GICA DE INSTALAÃ‡ÃƒO (PWA) ---
let deferredPrompt;
const installBtn = document.getElementById('install-btn');

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  installBtn.classList.remove('hidden');
});

installBtn.addEventListener('click', async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;
    if (outcome === 'accepted') {
      installBtn.classList.add('hidden');
    }
    deferredPrompt = null;
  }
});

// REGISTRAR SERVICE WORKER
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js').then(() => console.log("App Pronto!"));
  });
}
</script>
</body>
</html>
